extends layout

block content
  .wrapper
    .container
      .row.content-middle.mx-0.px-0
        .col-12.p-0.mt-5
          .card.text-center.mt-3
            .card-header.mt-3
              h4.text-dark 근무일지 작성
            .card-body.text-dark
              form#workForm(name='workForm')
                //, method='post', action='/work/insert', onsubmit='return fnCheckSubmit()')
                .row
                  .col-lg-6.col-md-8.col-sm-6.my-1
                    .form-group
                      label.w80px 근무일
                      .d-inline-block.w220px
                        input#work_date.form-control.datetimepicker(type='text' name='work_date')
                  .col-md-6
                    .form-group
                      label.w80px 팀
                      .d-inline-block.w220px
                        input#user_team.form-control(type='text', name='work_team', value=user.user_team, readonly)
                .row
                  .col-md-6
                    .form-group
                      label.w80px 지역
                      select#region.selectpicker(data-style="select-with-transition btn-neutral border text-dark btn-round w220px" name='region_name')
                        each item in region
                          option(value=item.region_name, selected=user.user_region===item.region_name) #{item.region_name}
                  .col-md-6
                    .form-group
                      label.w80px 현장명
                      .form-group.d-inline-block
                        input.form-control.w220px(type='text', name='work_place', value=user.work_place)
                .row
                  .col-lg-6.col-md-8.col-sm-6.my-1
                    label.w80px 출근시간
                    .form-group.d-inline-block
                      input.form-control.w220px#timepicker_start(type='text', name='start_time', value=last_work.start_time||'')
                  .col-lg-6.col-md-8.col-sm-6.my-1
                    label.w80px 퇴근시간
                    .form-group.d-inline-block
                      input.form-control.w220px#timepicker_end(type='text', name='end_time', value=last_work.end_time)
                  .col-lg-6.col-md-8.col-sm-6.my-1
                    label.w80px 작업사항
                    .form-group.d-none(title='work_title')
                      .d-flex.w220px
                        input.form-control(type='text', name='work_title_etc')
                        a.addon-switch-selectbox(href='#', onclick='fnChangeSelect("work_title")') 작업선택
                    select#work_title.selectpicker(data-style="select-with-transition btn-neutral border text-dark btn-round w220px" data-live-search="true" name='work_title')
                      each item in work_title
                        option(value=item.work_title, selected=last_work.work_title===item.work_title) #{item.work_title}
                      option(value='직접입력' onselect='fnChangeSelect("work_title")') 직접입력
                  .col-lg-6.col-md-8.col-sm-6.my-1
                    label.w80px 비고
                    .form-group.d-none(title='remarks')
                      .d-flex.w220px
                        input.form-control(type='text', name='remarks_etc')
                        a.addon-switch-selectbox(href='#', onclick='fnChangeSelect("remarks")') 비고선택
                    select#remarks.selectpicker(data-style="select-with-transition btn-neutral border text-dark btn-round w220px" name='remarks')
                      each item in remark
                        option(value=item.remark) #{item.remark}
                      option(value='직접입력' onselect='fnChangeSelect("remarks")') 직접입력
                .row.justify-content-center
                  button.btn.btn-success(type='button' onclick='fnCheckSubmit()') 등록하기 
                    i.now-ui-icons.ui-1_check
                input(type='hidden', name='temp_start_time', value=last_work.start_time)
                input(type='hidden', name='temp_end_time', value=last_work.end_time)
  #closedModal.modal.fade(tabindex="-1", role="dialog", aria-labelledby="closedModalLabel", aria-hidden="true")
    .modal-dialog.modal-lg(role="document")
      .modal-content
        .modal-header
          h5#closedModalLabel.modal-title 휴무계 작성
          button.close(type='button', data-dismiss='modal', aria-label='Close')
            span(aria-hidden='true')
        .modal-body
          form#formClosed
            .table.table-responsive
              table.table.text-center.table-bordered#tableClosed
                colgroup
                  col(style='background-color:#aaa;')
                  col(style='background-color:#aaa;')
                  col(width=200)
                  col(width=200)
                  col(width=200)
                tbody
                  tr
                    th.text-nowrap(rowspan=2, width='80px') 신청구분
                    th.text-nowrap(width='60px') 유급
                    td
                      .form-check.text-left.text-nowrap
                        label.form-check-label
                          input.form-check-input(type="checkbox", name='closed_type', value='annualLeave', onclick='fnSelectType(this)')
                          span.form-check-sign
                          | 연차
                    td
                      .form-check.text-left.text-nowrap
                        label.form-check-label
                          input.form-check-input(type="checkbox", name='closed_type', value='reserveForces', onclick='fnSelectType(this)')
                          span.form-check-sign
                          | 예비군/민방위훈련
                    td
                      .form-check.text-left.text-nowrap
                        label.form-check-label
                          input.form-check-input(type="checkbox", name='closed_type', value='familyEvent', onclick='fnSelectType(this)')
                          span.form-check-sign
                          | 경조사(취업규칙에근거)
                  tr
                    th 무급
                    td(colspan=2)
                      .form-check.text-left.text-nowrap
                        label.form-check-label
                          input.form-check-input(type="checkbox", name='closed_type', value='Absenteeism', onclick='fnSelectType(this)')
                          span.form-check-sign
                          | 무단결근(현장보고 및 본사에 휴가계 사후제출 시)
                    td
                      .form-check.text-left.text-nowrap
                        label.form-check-label
                          input.form-check-input(type="checkbox", name='closed_type', value='tardy', onclick='fnSelectType(this)')
                          span.form-check-sign
                          | 지각/조퇴
                  tr
                    th(colspan=2, rowspan=2) 신청인
                    td 부서
                    td 직급
                    td 성명
                  tr
                    td.input-td
                      input(type='text', name='department')
                    td.input-td
                      input(type='text', name='rank')
                    td.input-td
                      input(type='text', name='user_nick')
                  tr
                    th(colspan=2, rowspan=2) 신청기간
                    td.input-td(colspan=3)
                      input(type='text', name='application_period')
                  tr
                    td(colspan=3)
                      | ( &nbsp;
                      input.text-center.type_num(type='text', name='days')
                      | &nbsp; ) &nbsp; 일 간
                  tr
                    th(colspan=2) 사유
                    td.input-td(colspan=3)
                      input(type='text', name='reason')
                  tr
                    th(colspan=2, rowspan=2) 현장보고
                    td 허가자 성명
                    td 보고일시
                    td 허가자 연락처
                  tr
                    td.input-td
                      input(type='text', name='licenserName')
                    td.input-td
                      input(type='text', name='reportDate')
                    td.input-td
                      input(type='text', name='licenserTel')
            p 위와 같이 휴무계를 사용하고자 하오니 허가하여 주시기 바랍니다.
            .text-right
              input.type_num.text-center(type='text', name='closed_year')
              span 년
              input.type_num.text-center(type='text', name='closed_month')
              span 월
              input.type_num.text-center(type='text', name='closed_day')
              span 일
            br
            p.text-danger.mb-0 ※ 휴무의 당일 현장보고 및 회사보고 = 무급에 해당함.
            p.text-danger &nbsp;&nbsp;&nbsp; 단, 병가로 인한 경우 병원 진단서 또는 진료확인서 제출시에는 연차 처리 가능.
            h4 KTOP Inc. 대표이사 귀하

        .modal-footer.justify-content-center
          button.btn.btn-danger.mr-3(type="button" data-dismiss="modal") 닫기
          button.btn.btn-info(type="button", onclick='fnCompleteWrite()') 작성완료
block append_js
  script(src='/assets/js/custom/work.js', type='text/javascript')
  script.
    console.log(!{JSON.stringify(user)})
    let user = !{JSON.stringify(user)};
    if(user.lv === 9) $('#closedModal').modal('show');
    // alert('add');
